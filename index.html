<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description"
    content="CodeRosetta: Pushing the Boundaries of Unsupervised Code Translation for Parallel Programming.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CodeRosetta: Pushing the Boundaries of Unsupervised Code Translation for Parallel Programming</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">CodeRosetta: Pushing the Boundaries of Unsupervised Code
              Translation for Parallel Programming</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://tehrani.xyz">Ali Tehrani</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://www.cs.iastate.edu/arbhatt9">Arijit Bhattacharjee</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://www.cs.iastate.edu/lechen">Le Chen</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a href="http://nesreenahmed.com/">Nesreen K. Ahmed</a><sup>2</sup>,
              </span>
              <span class="author-block">
                <a href="https://www.ayazdan.com/">Amir Yazdanbakhsh</a><sup>3</sup>,
              </span>
              <span class="author-block">
                <a href="https://swapp.cs.iastate.edu/people/ali-jannesari">Ali Jannesari</a><sup>1</sup>,
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>Iowa State University</span> <br />
              <span class="author-block"><sup>2</sup>Intel Labs</span> <br />
              <span class="author-block"><sup>3</sup>Google DeepMind</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="https://openreview.net/forum?id=V6hrg4O9gg"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://github.com/tehranixyz/CodeRosetta"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <!-- Dataset Link. -->
                <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div> -->

              </div>
            </div>
          </div>
        </div>
      </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>Automatic translation of programming languages has garnered renewed interest, driven by recent
              advancements in large language models (LLMs). Encoder-decoder transformer models, in particular, have
              shown promise in translating between different programming languages. However, translating between a
              language and its high-performance computing (HPC) extension remains underexplored due to inherent
              challenges like complex parallel semantics understanding. In this paper, we introduce CodeRosetta, an
              encoder-decoder transformer model explicitly designed for translating between programming languages and
              also their HPC extensions. CodeRosetta is evaluated on C++ &harr; CUDA and C++ &harr; Fortran translation.
              It employs a customized learning-based framework with tailored pretraining and training objectives to
              effectively capture code semantics and parallel structural nuances, allowing for bidirectional code
              translation. Our results show that CodeRosetta outperforms state-of-the-art baselines in C++ to CUDA
              translation by 2.9 BLEU and 1.72 CodeBLEU points while improving compilation accuracy by 6.05%. Compared
              to general closed-source LLMs, our proposed bidirectional learning-based method improves C++ to CUDA
              translation by 22.08 BLEU and 14.39 CodeBLEU with 2.75% higher compilation accuracy. Finally, CodeRosetta
              exhibits proficiency in Fortran to parallel C++ translation, marking it, to our knowledge, as the first
              encoder-decoder model for such a complex translation task, improving CodeBLEU at least by 4.63 points
              compared to closed-source LLMs and Open Code LLMs.</p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->
    </div>
  </section>

<hr>
<section class="section">
  <div class="container is-max-desktop">
    <!-- Demonstration -->
    <!-- Code Snippets Stacked -->
    <div class="content has-text-justified">
      <div class="code-snippets" style="display: block; gap: 20px;">

        <!-- C++ Code -->
        <figure class="code-block" style="overflow-x: auto; margin-bottom: 20px;">
          <figcaption style="text-align: left; font-weight: bold; margin-bottom: 5px;">C++ Code:</figcaption>
          <pre style="background-color: #f5f5f5; color: #333; padding: 10px; border-radius: 5px; font-family: Consolas, 'Courier New', monospace; text-align: left; white-space: pre-wrap;">
            <code id="cpp-code">
<span style="color: #0000ff;">void</span> pow_cpu(<span style="color: #ff0000;">int</span> N, <span style="color: #ff0000;">float</span> ALPHA, <span style="color: #ff0000;">float</span>* X, <span style="color: #ff0000;">int</span> INCX, <span style="color: #ff0000;">float</span>* Y, <span style="color: #ff0000;">int</span> INCY) {
  <span style="color: #ff0000;">int</span> i;
  <span style="color: #0000ff;">for</span> (i = <span style="color: #09885a;">0</span>; i &lt; N; ++i) {
    Y[i * INCY] = <span style="color: #0000ff;">pow</span>(X[i * INCX], ALPHA);
  }
}
            </code>
          </pre>
        </figure>

        <!-- CUDA Code -->
        <figure class="code-block" style="overflow-x: auto;">
          <figcaption style="text-align: left; font-weight: bold; margin-bottom: 5px;">CUDA Code:</figcaption>
          <pre id="cuda-code-container" style="background-color: #f5f5f5; color: #333; padding: 10px; border-radius: 5px; font-family: Consolas, 'Courier New', monospace; text-align: left; white-space: pre-wrap;"></pre>
        </figure>

      </div>
    </div>
  </div>
</section>

<script>
  const cudaCode = `__global__ void pow_gpu(int N, float ALPHA,
  float *X, int INCX, float *Y, int INCY) {
    int i = (blockIdx.x + blockIdx.y * gridDim.x) * blockDim.x + threadIdx.x;
    if (i < N) {
      Y[i * INCY] = pow(X[i * INCX], ALPHA);
    }
  };`;

  // Define regex patterns for different syntax types
  const keywordRegex = /(__global__|void|if|return|pow|gridDim|blockDim|threadIdx|blockIdx)/g;
  const typeRegex = /(int|float)/g;
  const functionRegex = /pow/g;
  const operatorRegex = /(=|\+|\*|<|\(|\)|\{|\})/g;

  const cudaContainer = document.getElementById('cuda-code-container');
  let index = 0;
  let typingInterval;

  function typeCode() {
    if (index < cudaCode.length) {
      let char = cudaCode[index];

      // Check for new lines
      if (char === '\n') {
        cudaContainer.innerHTML += '<br>'; // Handle new lines
      } else if (char.match(keywordRegex)) {
        let match = cudaCode.slice(index).match(keywordRegex);
        if (match) {
          cudaContainer.innerHTML += `<span style="color: #0000ff;">${match[0]}</span>`;
          index += match[0].length - 1;
        }
      } else if (char.match(typeRegex)) {
        let match = cudaCode.slice(index).match(typeRegex);
        if (match) {
          cudaContainer.innerHTML += `<span style="color: #ff0000;">${match[0]}</span>`;
          index += match[0].length - 1;
        }
      } else if (char.match(functionRegex)) {
        let match = cudaCode.slice(index).match(functionRegex);
        if (match) {
          cudaContainer.innerHTML += `<span style="color: #09885a;">${match[0]}</span>`;
          index += match[0].length - 1;
        }
      } else if (char.match(operatorRegex)) {
        let match = cudaCode.slice(index).match(operatorRegex);
        if (match) {
          cudaContainer.innerHTML += `<span style="color: #333;">${match[0]}</span>`;
          index += match[0].length - 1;
        }
      } else {
        cudaContainer.innerHTML += char; // Append the character
      }
      index++;
      setTimeout(typeCode, 50); // Adjust speed here
    } else {
      clearInterval(typingInterval); // Clear interval when done
    }
  }

  // Check if the CUDA code is in view
  function checkScroll() {
    const cudaCodeSection = document.getElementById('cuda-code-container').parentElement;
    const bounding = cudaCodeSection.getBoundingClientRect();
    if (bounding.top < window.innerHeight && bounding.bottom > 0) {
      // Start typing if not already started
      if (!typingInterval) {
        typingInterval = setInterval(typeCode, 15000); // Repeat typing every 15 seconds
        typeCode(); // Start typing immediately
      }
      window.removeEventListener('scroll', checkScroll); // Remove listener after first trigger
    }
  }

  window.addEventListener('scroll', checkScroll); // Add scroll listener
</script>

  
  <hr>
  
  <section class="section">
    <div class="container is-max-desktop">
      <!-- Demonstration -->
      <!-- Code Snippets Stacked -->
      <div class="content has-text-justified">
        <div class="code-snippets" style="display: block; gap: 20px;">
  
          <!-- Fortran Code -->
          <figure class="code-block" style="overflow-x: auto; margin-bottom: 20px;">
            <figcaption style="text-align: left; font-weight: bold; margin-bottom: 5px;">Fortran Code:</figcaption>
            <pre style="background-color: #f5f5f5; color: #333; padding: 10px; border-radius: 5px; font-family: Consolas, 'Courier New', monospace; text-align: left; white-space: pre-wrap;">
              <code id="fortran-code-container"></code>
            </pre>
          </figure>
  
          <!-- C++ Code -->
          <figure class="code-block" style="overflow-x: auto;">
            <figcaption style="text-align: left; font-weight: bold; margin-bottom: 5px;">C++ Code:</figcaption>
            <pre style="background-color: #f5f5f5; color: #333; padding: 10px; border-radius: 5px; font-family: Consolas, 'Courier New', monospace; text-align: left; white-space: pre-wrap;">
              <code id="cpp-code">
  <span style="color: #0000ff;">void</span> add() {
    <span style="color: #ff0000;">int</span> i, j, k, m;
    <span style="color: #ff0000;">int</span> thread_id = omp_get_thread_num();
    <span style="color: #0000ff;">if</span> (timeron && thread_id == 0) {
      timer_start(T_ADD);
    }
    <span style="color: #0000ff;">#pragma</span> omp for
    <span style="color: #0000ff;">for</span> (k = 1; k &lt;= nz2; k++) {
      <span style="color: #0000ff;">for</span> (j = 1; j &lt;= ny2; j++) {
        <span style="color: #0000ff;">for</span> (i = 1; i &lt;= nx2; i++) {
          <span style="color: #0000ff;">for</span> (m = 0; m &lt; 5; m++) {
            u[k][j][i][m] = u[k][j][i][m] + rhs[k][j][i][m];
          }
        }
      }
    }
    <span style="color: #0000ff;">if</span> (timeron && thread_id == 0) {
      timer_stop(T_ADD);
    }
  }
              </code>
            </pre>
          </figure>
  
        </div>
      </div>
    </div>
  </section>

<script>
  // Fortran code to be typed out
  const fortranCode = `subroutine add
  use sp_data
  implicit none
  integer :: i, j, k, m
  if (timeron) call timer_start(t_add)
  do k = 1, nz2
    do j = 1, ny2
      do i = 1, nx2
        do m = 1, 5
          u(m, i, j, k) = u(m, i, j, k) + rhs(m, i, j, k)
        end do
      end do
    end do
  end do
  if (timeron) call timer_stop(t_add)
  return
  end subroutine add`;

  function typeFortranCode() {
    // Define regex patterns for different syntax types
    const keywordRegex = /subroutine|use|implicit|if|do|end do|return/g;
    const typeRegex = /integer/g;
    const operatorRegex = /(=|\+|,|&lt;|&gt;|\(|\)|\{|\})/g;

    const fortranContainer = document.getElementById('fortran-code-container');
    let index = 0;
    let typingInterval;

    function type() {
      if (index < fortranCode.length) {
        let char = fortranCode[index];

        // Check for new lines
        if (char === '\n') {
          fortranContainer.innerHTML += '<br>'; // Handle new lines
        } else if (char.match(keywordRegex)) {
          let match = fortranCode.slice(index).match(keywordRegex);
          if (match) {
            fortranContainer.innerHTML += `<span style="color: #0000ff;">${match[0]}</span>`;
            index += match[0].length - 1;
          }
        } else if (char.match(typeRegex)) {
          let match = fortranCode.slice(index).match(typeRegex);
          if (match) {
            fortranContainer.innerHTML += `<span style="color: #ff0000;">${match[0]}</span>`;
            index += match[0].length - 1;
          }
        } else if (char.match(operatorRegex)) {
          let match = fortranCode.slice(index).match(operatorRegex);
          if (match) {
            fortranContainer.innerHTML += `<span style="color: #333;">${match[0]}</span>`;
            index += match[0].length - 1;
          } else {
            fortranContainer.innerHTML += char; // Append the character
          }
        } else {
          fortranContainer.innerHTML += char; // Append the character
        }
        index++;
        setTimeout(type, 50); // Adjust speed here
      } else {
        clearInterval(typingInterval); // Clear interval when done
      }
    }

    // Check if the Fortran code is in view
    function checkScroll() {
      const fortranCodeSection = document.getElementById('fortran-code-container').parentElement;
      const bounding = fortranCodeSection.getBoundingClientRect();
      if (bounding.top < window.innerHeight && bounding.bottom > 0) {
        // Start typing if not already started
        if (!typingInterval) {
          typingInterval = setInterval(type, 15000); // Repeat typing every 15 seconds
          type(); // Start typing immediately
        }
        window.removeEventListener('scroll', checkScroll); // Remove listener after first trigger
      }
    }

    window.addEventListener('scroll', checkScroll); // Add scroll listener
  }

  // Start the typing animation for Fortran code
  typeFortranCode(); 
</script>



  <hr>
  



  <section class="section">
    <div class="container is-max-desktop">
      <!-- Pretraining and Training Objectives. -->
      <h2 class="title is-3 is-centered has-text-centered">Pretraining and Training Objectives</h2>
      <div class="content has-text-justified">
        <h3>Mask Language Modeling</h3>
        <p>
          Pre-training is essential for transformer models to understand programming languages, and Masked Language
          Modeling (MLM) is used to mask entire words in code, helping the model learn both syntactic and semantic
          patterns. This method, which masks full words like "int" in "int index," helps the model predict the missing
          tokens by understanding the context. Additionally, training the model on a combined dataset of C++ and the
          target language (CUDA or Fortran) enables cross-lingual learning, allowing the model to generalize and
          transfer knowledge across programming languages.
        </p>
      </div>
      <!-- Make sure the figure is full width inside the column -->
      <figure class="image is-fullwidth">
        <img src="static/images/mlm.png" alt="Architecture" style="max-width: 100%; height: auto; object-fit: contain;">
      </figure> <br />
      <div class="content has-text-justified">
        <h3>Abstract Syntaxt Tree Entity Recognition</h3>
        <p>
          Following cross-lingual MLM pre-training, we introduce Abstract Syntax Tree (AST) Entity Recognition (AER) to
          improve CodeRosetta's understanding of code structure. AER allows the model to recognize and categorize
          syntactic elements in code, similar to how Named Entity Recognition works in natural language processing. By
          leveraging ASTs generated from source code, AER pre-training enables CodeRosetta to predict syntactic roles,
          improving its adaptability across different programming languages and paradigms, such as CUDA.
        </p>
      </div>
      <!-- Image follows the same pattern -->
      <figure class="image is-fullwidth">
        <img src="static/images/aer.png" alt="Architecture" style="max-width: 100%; height: auto; object-fit: contain;">
      </figure><br />
      <div class="content has-text-justified">
        <h3>Denoising Auto Encoding</h3>
        <p>
          The decoder in CodeRosetta is untrained after pre-training, so Denoising Auto-Encoding (DAE) is used to train
          it for code translation. DAE involves corrupting input code with various noise types (e.g., token masking,
          shuffling) and training the model to reconstruct the original, enabling the decoder to learn target language
          syntax. Additionally, techniques like weighted token dropping (removing language-specific keywords) and
          language-specific token insertion (inserting tokens from other languages) help the model distinguish between
          programming languages, with adaptive noise ratios gradually increasing complexity during training.
        </p>
      </div>
      <!-- Apply the same technique to all figures -->
      <figure class="image is-fullwidth">
        <img src="static/images/dae.png" alt="Architecture" style="max-width: 100%; height: auto; object-fit: contain;">
      </figure><br />
      <div class="content has-text-justified">
        <h3>Back Translation</h3>
        <p>
          To enhance CodeRosetta's translation quality and grasp of complex code semantics, back translation is
          employed. This process involves translating code from a source to a target language (e.g., C++ to CUDA) and
          then performing reverse translation (CUDA to C++) to reconstruct the original source code. The model refines
          its accuracy by comparing the reconstructed code with the original, iteratively improving its understanding of
          language differences and code structures, while alternating between language pairs to prevent bias and ensure
          balanced learning.
        </p>
      </div>
      <figure class="image is-fullwidth">
        <img src="static/images/bt.png" alt="Architecture" style="max-width: 100%; height: auto; object-fit: contain;">
      </figure><br />
    </div>
  </section>

  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@inproceedings{
      tehranijamsaz2024coderosetta,
      title={CodeRosetta: Pushing the Boundaries of Unsupervised Code Translation for Parallel Programming},
      author={TehraniJamsaz, Ali and Bhattacharjee, Arijit and Chen, Le and Ahmed, Nesreen K and Yazdanbakhsh, Amir and Jannesari, Ali},
      booktitle={Proceedings of the 38th International Conference on Neural Information Processing Systems},
      year={2024},
      url={https://openreview.net/forum?id=V6hrg4O9gg}
      }</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <a class="icon-link" href="">
          <i class="fas fa-file-pdf"></i>
        </a>
        <a class="icon-link" href="https://github.com/tehranixyz/CodeRosetta" class="external-link" disabled>
          <i class="fab fa-github"></i>
        </a>
      </div>
      <div class="columns is-centered">
        <div class="column is-8 has-text-centered">
          <div class="content">
            <p>
              Template adapted from <a href="http://nerfies.github.io/">Nerfies</a> by Keunhong Park et al.
              and uses <a href="https://bulma.io/">Bulma</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
  

</body>

</html>